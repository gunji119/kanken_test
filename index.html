<!doctype html>
<html lang="ja">
<head>
  <meta name="robots" content="noindex, nofollow">
<meta charset="utf-8" />
<title>単身世帯の幸福度診断｜関心×満足レーダー</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
<style>
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  max-width:720px;
  margin:40px auto;
  padding:0 20px;
  line-height:1.6;
  background:#fff;
}
.card{
  border:1px solid #ddd;
  border-radius:14px;
  padding:20px;
  margin:20px 0;
  background:#fff;
}
button{
  padding:.6rem 1rem;
  border:1px solid #111;
  border-radius:10px;
  background:#fff;
  cursor:pointer;
}
button:hover{background:#f5f5f5;}
h1{font-size:26px}
h2{font-size:20px;margin-top:0}
.hidden{display:none}
.choice{display:flex;flex-direction:column;gap:8px;margin-top:20px}
.bar{width:100%;height:8px;background:#eee;border-radius:4px;margin-top:20px;overflow:hidden}
.bar-inner{height:100%;background:#111;width:0%;transition:width .3s ease}
.chart-wrap{height:380px;margin-top:20px}
.table{width:100%;border-collapse:collapse;margin-top:10px}
.table th,.table td{border:1px solid #ddd;padding:6px;text-align:center}
.badge{background:#111;color:#fff;font-size:12px;border-radius:8px;padding:2px 6px}
ul{padding-left:20px}
</style>
</head>
<body>
<h1>単身世帯の幸福度診断</h1>
<p>あなたの「関心」と「満足」を比べて、自分らしい幸福の形を見つけましょう。</p>

<section id="quiz" class="card">
  <h2 id="qnum"></h2>
  <p id="qtext"></p>
  <div class="choice" id="choices"></div>
  <div class="bar"><div class="bar-inner" id="progress"></div></div>
</section>

<section id="result" class="card hidden">
  <h2>診断結果</h2>
  <div class="chart-wrap"><canvas id="chart"></canvas></div>
  <h3>因子ごとの平均値</h3>
  <table class="table">
    <thead><tr><th>因子</th><th>関心</th><th>満足</th><th>差</th></tr></thead>
    <tbody id="tbl"></tbody>
  </table>
  <h3>重点提案 <span class="badge">関心高×満足低</span></h3>
  <ul id="tips"></ul>
  <button onclick="location.reload()">もう一度診断する</button>
</section>

<script>
// === 因子と質問（単身世帯の幸福度テーマ） ===
const FACTORS = [
  "賃金",
  "働き方の裁量",
  "財産管理",
  "安心",
  "食生活",
  "住居への満足"
];

const QUESTIONS = [
  // 賃金
  {text:"収入は生活を支える上でとても重要だと思う",factor:"賃金",type:"関心"},
  {text:"現在の収入におおむね満足している",factor:"賃金",type:"満足"},
  // 働き方の裁量
  {text:"自分で仕事のペースや方法を決められることを重視している",factor:"働き方の裁量",type:"関心"},
  {text:"今の働き方には十分な自由があると感じる",factor:"働き方の裁量",type:"満足"},
  // 財産管理
  {text:"お金や資産をきちんと管理できていると安心できる",factor:"財産管理",type:"関心"},
  {text:"現在、自分の収支や貯蓄をきちんと把握できている",factor:"財産管理",type:"満足"},
  // 安心
  {text:"病気や失業などのリスクに備えることを大切にしている",factor:"安心",type:"関心"},
  {text:"いざという時に頼れる制度や人がいると感じている",factor:"安心",type:"満足"},
  // 食生活
  {text:"毎日の食事の質は幸福に直結すると感じる",factor:"食生活",type:"関心"},
  {text:"最近の食生活には満足している",factor:"食生活",type:"満足"},
  // 住居
  {text:"自分に合った住環境を持つことは大切だと思う",factor:"住居への満足",type:"関心"},
  {text:"今の住まいに満足している",factor:"住居への満足",type:"満足"}
];

const TIPS = {
  "賃金":["副収入やスキル投資で長期的に底上げを検討","生活コストを見直し、満足を再定義"],
  "働き方の裁量":["上司・同僚と裁量範囲を共有し、無理のない自由を設計","働き方を記録してストレスポイントを可視化"],
  "財産管理":["自動積立や家計アプリで管理を習慣化","月1の振り返りで安心感を維持"],
  "安心":["頼れる人や制度のリスト化","健康・貯蓄・保険のいずれかを優先して整備"],
  "食生活":["平日と休日で無理なく続く食習慣を設計","冷凍・宅食サービスで自炊の負担を軽減"],
  "住居への満足":["小さな模様替えや掃除で『居心地の良さ』をアップ","家賃・立地・快適度のバランスを再検討"]
};

// === 診断ロジック ===
let idx=0;
let answers=[];
const quiz=document.getElementById("quiz");
const qnum=document.getElementById("qnum");
const qtext=document.getElementById("qtext");
const choices=document.getElementById("choices");
const progress=document.getElementById("progress");
const OPTIONS=["全くそう思わない","あまりそう思わない","どちらともいえない","ややそう思う","とてもそう思う"];

function showQuestion(){
  const q=QUESTIONS[idx];
  qnum.textContent=`質問 ${idx+1} / ${QUESTIONS.length}`;
  qtext.textContent=q.text;
  choices.innerHTML="";
  OPTIONS.forEach((opt,i)=>{
    const b=document.createElement("button");
    b.textContent=`${i+1}. ${opt}`;
    b.onclick=()=>answer(i+1);
    choices.appendChild(b);
  });
  progress.style.width=`${(idx/QUESTIONS.length)*100}%`;
}

function answer(val){
  answers.push(val);
  idx++;
  if(idx<QUESTIONS.length){showQuestion();}
  else{analyze();}
}

function analyze(){
  progress.style.width="100%";
  quiz.classList.add("hidden");
  document.getElementById("result").classList.remove("hidden");

  // 因子ごとの平均算出
  const sums={};
  FACTORS.forEach(f=>sums[f]={関心:[],満足:[]});
  QUESTIONS.forEach((q,i)=>sums[q.factor][q.type].push(answers[i]));
  const interest=FACTORS.map(f=>avg(sums[f].関心));
  const satisfaction=FACTORS.map(f=>avg(sums[f].満足));

  // === レーダーチャート描画 ===
  new Chart(document.getElementById("chart"), {
    type: "radar",
    data: {
      labels: FACTORS,
      datasets: [
        {
          label: "関心度",
          data: interest,
          fill: true,
          pointRadius: 3,
          backgroundColor: "rgba(255, 205, 86, 0.3)", // 黄色
          borderColor: "rgba(255, 205, 86, 1)",
          borderWidth: 2
        },
        {
          label: "満足度",
          data: satisfaction,
          fill: true,
          pointRadius: 3,
          backgroundColor: "rgba(54, 162, 235, 0.25)", // 青
          borderColor: "rgba(54, 162, 235, 1)",
          borderWidth: 2
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: "top" },
        tooltip: { mode: "nearest", intersect: false }
      },
      scales: {
        r: {
          beginAtZero: true,
          min: 0,
          max: 5,
          ticks: { stepSize: 1 },
          angleLines: { color: "rgba(0,0,0,0.08)" },
          grid: { color: "rgba(0,0,0,0.08)" },
          pointLabels: { font: { size: 12 } }
        }
      },
      elements: { line: { borderWidth: 2 } }
    }
  });

  // === テーブル表示 ===
  const tbody=document.getElementById("tbl");
  const diffs=FACTORS.map((f,i)=>({
    f, interest:interest[i], satisfaction:satisfaction[i], gap:interest[i]-satisfaction[i]
  })).sort((a,b)=>b.gap-a.gap);
  diffs.forEach(d=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${d.f}</td>
      <td>${d.interest.toFixed(1)}</td>
      <td>${d.satisfaction.toFixed(1)}</td>
      <td>${d.gap.toFixed(1)}</td>`;
    tbody.appendChild(tr);
  });

  // === 提案表示 ===
  const ul=document.getElementById("tips");
  ul.innerHTML="";
  diffs.filter(d=>d.interest>=4&&d.gap>=1.5).forEach(d=>{
    const li=document.createElement("li");
    const t=TIPS[d.f]||["提案なし"];
    li.innerHTML=`<strong>${d.f}</strong>：${t.join("・")}`;
    ul.appendChild(li);
  });
}

function avg(arr){return arr.length?arr.reduce((a,b)=>a+b,0)/arr.length:0;}

showQuestion();
</script>
</body>
</html>
